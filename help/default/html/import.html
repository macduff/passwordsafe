<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Importing Entries</title>
<!-- pwsafe version: 2.11--><!-- Modified: 15/06/2005 --><!--Popup control -->
<script language="javascript" src="html/popups.js">
</script>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<object id="popup" type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"></object>
<!-- Popup Source File -->

<h2>Importing Entries</h2>

<p><b>Password Safe</b> allows you to import
password information from other formats. These files may be generated by other applications,
exported from a spreadsheet, or even written by hand using Notepad or a similar
text editor.</p>

<p>The formats that <b>Password Safe</b> supports are:</p>

<ul>
<li><a href="#text">Text</a></li>
<li><a href="#XML">XML</a></li>
<li><a href="#KeePassV1_TXTCSV">KeePass V1 TXT and CSV Files</a></li>
<li><a href="#KeePassV2_CSV">KeePass V2 via KeePass V1 CSV Files</a></li>
<li><a href="#KeePassXML">KeePass V1 and V2 XML Files</a></li>
</ul>

<p>In addition, to 'import' a subset of entries from another <b>Password Safe</b>
database, just start <b>Password Safe</b> (assuming you permit multiple instances via
<a href="system_tab.html">"Manage&nbsp;&rarr;&nbsp;Options&nbsp;&rarr;&nbsp;System"</a>
tab) and open the other database, whilst having your normal database open in another
instance. Then you can simply drag and drop any entries or groups to your open database
from this 'import' database. </p>

<p>A report of the actions taken will be available on completion and this may
be copied to the clipboard or saved to disk as a text file in the same directory
as the database. The "View&nbsp;&rarr;&nbsp;Reports" menu item may then be used to
view the reports at a later date. The name of the report file is fixed and
dependent on the function that created it. If the same function is repeated
and its report saved to disk, any existing report for this function will be
overwritten. <span style="color=red;">Note: The report may contain sensitive data and
care should be taken when selecting the "save to disk" option.</span></p>

<h3><a name="text"></a>Text Format</h3>

<p>Text files used to import password entries consist of one or
more password entries. Each field within an entry is separated by a
field separator and each entry may consist of one or more
lines. Details on the expected format of the imported text file
may be found in the "<a href="imp_exp_text_details.html">Plain Text Export &amp; Import Format</a>" section.</p>

<h3>Import Text Settings Dialog</h3>

<p>The field separator used in the text file being imported and a default group
name to import the new entries into can be configured before processing the file.</p>

<p><img alt="Import Text Settings" src="images/import.jpg"></p>
<ol>
<li><b>"File&nbsp;&rarr;&nbsp;Import From...."</b></li>
<li>Select <b>Plain Text...</b></li>
<li>Set import settings and parameters for the text file being imported</li>
<li>If a Notes field multi-line delimiter character has been
used, either in a previous Export or using a text editor, enter it here
so that, during the Import process, the Notes field will be split into
multiple lines by replacing this character by a newline.</li>
<li>Click <b>OK</b></li>
<li>Select the text file to import.</li>
<li>At the end of the import process, a small dialog box appears
showing how many entries were added, and how many (if any) were
unsuccessfully parsed.</li>
</ol>

<hr>
<small><b style="color: rgb(255, 0, 0);">IMPORTANT</b>: The
first line of the file being imported must be a tab-separated list of
the names of the fields that each entry contains, e.g.,
"Group/Title&nbsp;&nbsp;&nbsp; Username&nbsp;&nbsp;&nbsp;
Password&nbsp;&nbsp;&nbsp; URL", etc. This line is generated
automatically by the "<a href="export.html">Export Text</a>" function,
but must be added manually for files created from other tools.<br>
</small>

<hr style="width: 100%; height: 2px;">

<h3><a name="XML"></a>XML</h3>

<p>XML (eXtensible Markup Language) is a popular format for transferring
data between applications. <b>Password Safe</b>
can import XML files that were generated according to the schema defined in
the file <i>pwsafe.xsd</i>, which is provided as part of the distribution.</p>

<h3><a name="KeePassV1_TXTCSV"></a>KeePass V1 TXT and CSV Files</h3>

<p><u>The recommended import of KeePass V1 database entries is via XML as described
<a href="#KeePassXML">below</a></u>.</p>

<h4>TXT File</h4>

<p>You may also import a TXT file exported from Keepass V1 (tested on files created
by V1.19b).</p>

<p>The following fields are converted to the <b>Password Safe</b> equivalents:</p>
Each new entry starts with a line beginning with '[' and ending with as ']'. The text 
between these will be imported as the 'Title' of this entry.<p>

<p>Each piece of information is on one line and the following tags are at the beginning
of each line:</p>
<ul>
<li>"Group: " becomes the entry's Group</li>
<li>"Group Tree: " becomes the entry's group hierachy to the root</li>
<li>"User Name: " becomes the entry's User Name</li>
<li>"Password: " becomes the entry's Password</li>
<li>"URL: " becomes the entry's URL</li>
<li>"Notes: " becomes the entry's Notes</li>
<li>"UUID: " becomes the internal unique ID of the <b>Password Safe</b> entry</li>
<li>"Creation Time: " becomes the entry's creation time</li>
<li>"Last Access: " becomes the entry's last accessed time</li>
<li>"Last Modification: " becomes the entry's password and the entry's last modification time</li>
<li>"Expires: " becomes the entry's expiry date</li>
</ul>

<p>The following fields are ignored:</p>

<ul>
<li>"Icon"</li>
<li>"Attachment Description"</li>
<li>"Attachment" - do <b><u>NOT</u></b> export this field as it can make the export file extremely large.</li>
</ul>

<p>Note that times in <b>Password Safe</b> must be earlier than January 19, 2038.  Any time greater than this is
treated as invalid and that the associated field is unset.</p>

<p>Please note, you <b><u>MUST</u></b> check the box <i>"Encode/replace newline characters by '\n'"</i>
during the export from Keepass V1 or <u>the import may fail or give unexpected results.</u></p>

<h4>CSV File</h4>

<p>You may also import a CSV (Comma Separated Values) file exported from Keepass V1 (tested on files created
by V1.19b).</p>

<p>The following fields are converted to the <b>Password Safe</b> equivalents:</p>

<ul>
<li>"Password Groups" becomes the entry's Group</li>
<li>"Group Tree" becomes the entry's group hierachy to the root</li>
<li>"Account" becomes the entry's Title</li>
<li>"Login Name" becomes the entry's User Name</li>
<li>"Password" becomes the entry's Password</li>
<li>"Web Site" becomes the entry's URL</li>
<li>"Comments" becomes the entry's Notes</li>
<li>"UUID" becomes the internal unique ID of the <b>Password Safe</b> entry</li>
<li>"Creation Time" becomes the entry's creation time</li>
<li>"Last Access" becomes the entry's last accessed time</li>
<li>"Last Modification" becomes the entry's password and the entry's last modification time</li>
<li>"Expires" becomes the entry's expiry date</li>
</ul>

<p>The following fields are ignored:</p>

<ul>
<li>"Icon"</li>
<li>"Attachment Description"</li>
<li>"Attachment" - do <b><u>NOT</u></b> export this field as it can make the export file extremely large.</li>
</ul>

<p>Note that times in <b>Password Safe</b> must be earlier than January 19, 2038.  Any time greater than this is
treated as invalid and that the associated field is unset.</p>

<p>Please note, you <b><u>MUST</u></b> check the box <i>"Encode/replace newline characters by '\n'"</i>
during the export from Keepass V1 or <u>the import may fail or give unexpected results.</u></p>

<h3><a name="KeePassV2_CSV"></a>KeePass V2 via KeePass V1 CSV Files</h3>

<p><u>The recommended import of KeePass V2 database entries is via XML as described
<a href="#KeePassXML">below</a></u>.</p>

<p><b>Password Safe</b> cannot import any file created by KeePass V2 - even the KeePass V1 CSV format
available from this program, as it does not allow the important setting of the 
<i>"Encode/replace newline characters by '\n'"</i> requirement.  However, it is possible to
export a KeePass V2 database as a KeePass V1 database.  You may then export this to either a
TXT or CSV file and imported as described <a href="#KeePassV1_TXTCSV">above</a>.</p>

<h3><a name="KeePassXML"></a>KeePass V1 and V2 XML Files</h3>

<p><b>Password Safe</b> cannot directly import a XML file exported by KeePass V1 or V2 as the fields are
too different. However, we have provided XSL Transfom files (KPV1_to_PWS.xslt and KPV2_to_PWS.xslt).
Once exported from KeePass to an XML file, the programs below be used to process it with one
of these XSLT files to produce a <b>Password Safe</b> compatible XML file that can then be imported
in <b>Password Safe</b> <u>V3.26 or later</u>.</p>

<p>The XSLT files conform to V1.0 of XSLT as described in <a target="blank" href="http://www.w3.org/TR/xslt">
http://www.w3.org/TR/xslt</a> and have been tested with XML files created by KeePass V1.19b and KeePass V2.15.</p>

<p>Note that times in <b>Password Safe</b> must be earlier than January 19, 2038.  Any time greater than this is
treated as invalid and that the associated field is unset.</p>

<p>Under Windows, the following XSLT processors support the supplied XSL Transform files. The example
command line execution of these processors assume:<p>
<ul>
<li>The style sheet to convert the KeePass XML file to a <b>Password Safe</b> XML file is: KPV1_to_PWS.xslt or
KPV2_to_PWS.xslt.</li>
<li>The input KeePass V1 or V2 XML file is: KeePassV1.xml or KeePassV2.xml</li>
<li>The output <b>Password Safe</b> XML file will be: PWS.xml</li>
<li>All input and output files are in the same directory as the XSLT processor. If not, you will need to
enter the full path of these files when using the suggested command line invocation of these processors below.</li>
</ul>
<ol>
<li>The command line program from Microsoft (XSLT Processor Version 4.0). The properties of the file msxsl.exe state that it is V1.1.0.1 and dated 2001, although the web site states that it is V2.0 and dated 19 September 2004.
It can be found at
<a target="blank" href="http://www.microsoft.com/downloads/en/details.aspx?familyid=2fb55371-c94e-4373-b0e9-db4816552e41&displaylang=en">http://www.microsoft.com/downloads</a>.
It requires Microsoft Core XML Services (MSXML) V4.0 to be installed.  Whilst the latest MSXML version is V6, V4
is normally installed on all versions of Windows supported by <b>Password Safe</b>.
<p>For KeePass V1 XML file use the command:</p>
<pre>
msxsl KeePassV1.xml KPV1_to_PWS.xslt -o PWS.xml
</pre>
For KeePass V2 XML file use the command:
<pre>
msxsl KeePassV2.xml KPV2_to_PWS.xslt -o PWS.xml
</pre>
</li>
<li>AltovaXML Community Edition (current version 2011r2sp1).
See <a target="blank" href="http://www.altova.com/altovaxml.html">
http://www.altova.com/altovaxml.html</a>.
<p>For KeePass V1 XML file use the command:</p>
<pre>
AltovaXML -xslt1 KPV1_to_PWS.xslt -in KeePassV1.xml -out PWS.xml
</pre>
For KeePass V2 XML file use the command:
<pre>
AltovaXML -xslt1 KPV2_to_PWS.xslt -in KeePassV2.xml -out PWS.xml
</pre>
</li>
<li>Saxon-HE (Home Edition) (current version 9.3.0.5).
See <a target="blank" href="http://saxon.sourceforge.net/">http://saxon.sourceforge.net/</a>.
There is also a graphical front-end for Saxon called Kernow.
See <a target="blank" href="http://kernowforsaxon.sourceforge.net/">http://kernowforsaxon.sourceforge.net/</a>.
The format of the command depends on whether you use the Java or .Net version of Saxon-HE and/or Kernow.  Please
refer to the product's documentation for further information.</li>
</ol>

<p>All these programs are free, although Kernow needs to be registered if used more than 100 times.</p>

<h4>KeePass V2 XML Auto-type</h4>

<p>The following KeePass V2 Auto-type special codes (see
<a target="blank" href="http://keepass.info/help/base/autotype.html">http://keepass.info/help/base/autotype.html</a>) 
are translated as follows.  All codes not listed are copied across as-is.</p>

<table border="1" cellpadding="2" cellspacing="2 width="80%">
<col width="75%" />
<col align="center" width="25%" />
<thead>
<tr>
<th>KeePass V2 Auto-type</th>
<th>Password Safe Equivalent</th>
</tr>
</thead>
<tbody>
<tr><td>Tab {TAB}</td><td>\t</td></tr>
<tr><td>Enter {ENTER} or ~</td><td>\n</td></tr>
<tr><td>Backspace {BACKSPACE}, {BS} or {BKSP}</td><td>\b</td></tr>
<tr><td>Keypad + {ADD}</td><td>+</td></tr>
<tr><td>Keypad - {SUBTRACT}</td><td>-</td></tr>
<tr><td>Keypad * {MULTIPLY}</td><td>*</td></tr>
<tr><td>Keypad / {DIVIDE}</td><td>/</td></tr>
<tr><td>+ {+}</td><td>+</td></tr>
<tr><td>^ {^}</td><td>^</td></tr>
<tr><td>% {%}</td><td>%</td></tr>
<tr><td>~ {~}</td><td>~</td></tr>
<tr><td>{DELAY X} Delays X milliseconds.</td><td>\wX (\WX)</td></tr>
<tr><td>{DELAY=X} Sets the default delay to X milliseconds for all standard keypresses in this sequence.</td><td>\dX</td></tr>
<tr><td>\</td><td>\\</td></tr>
</tbody>
</table>

<p>The following KeePass V2 Placeholders (see 
<a target="blank" href="http://keepass.info/help/base/placeholders.html">http://keepass.info/help/base/placeholders.html</a>)
are translated as follows.  All codes not listed are copied across as-is.</p>

<table border="1" cellpadding="2" cellspacing="2 width="80%">
<col width="33%" />
<col align="center" width="33%" />
<col align="center" width="33%" />
<thead>
<tr>
<th>KeePass V2 Placeholder</th>
<th>Password Safe AutoType</th>
<th>Password Safe Run Command</th>
</tr>
</thead>
<tbody>
<tr><td>{GROUP}</td><td>\g</td><td>$G</td></tr>
<tr><td>{GROUPPATH}</td><td>-</td><td>$g</td></tr>
<tr><td>{TITLE}</td><td>\i</td><td>$t</td></tr>
<tr><td>{USERNAME}</td><td>\u</td><td>$u</td></tr>
<tr><td>{PASSWORD}</td><td>\p</td><td>$p</td></tr>
<tr><td>{URL}</td><td>-</td><td>$url</td></tr>
<tr><td>{NOTES}</td><td>\o</td><td>$n</td></tr>
<tbody>
</table>

<p></p>

<table border="1" cellpadding="2" cellspacing="2 width="80%">
<col align="left" width="50%" />
<col align="center" width="50%" />
<thead>
<tr>
<th>KeePass V2 Placeholder</th>
<th>Password Safe Run Command</th>
</tr>
</thead>
<tbody>
<tr><td>{APPDIR}</td><td>$appdir</td></tr>
<tr><td>{DB_PATH}</td><td>$fulldb</td></tr>
<tr><td>{DB_DIR}</td><td>$dbdir</td></tr>
<tr><td>{DB_NAME}</td><td>$dbname.$dbextn</td></tr>
<tr><td>{DB_BASENAME}</td><td>$dbname</td></tr>
<tr><td>{DB_EXT}</td><td>$dbextn</td></tr>
<tbody>
</table>

<!-- Added some white space at the bottom for natural scrolling -->
<br>
<br>
<br>

<object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="Keyword" value="Import Password Entries">
<param name="Keyword" value="Export Password Entries">
<param name="Keyword" value="Excel Password Data">
<param name="Keyword" value="Import KeePass Entries">
<param name="Keyword" value="Converting Existing Password Data">
</object>

</body>
</html>
